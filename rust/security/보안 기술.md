2. `quinn`(QUIC)
3. `rustls`(TLS 설정)


# CA키 만들기


## 1) 인증서 만들기 (CA 1개 + server 1개 + client 1개)

### 1-1) CA 생성

`mkdir -p certs/out cd certs/out  # CA 키/인증서 openssl genrsa -out ca.key 4096 openssl req -x509 -new -nodes -key ca.key -sha256 -days 3650 \   -subj "/CN=quic-tunnel-root-ca" \   -out ca.crt`

- `ca.key`: 너만 보관하는 루트 CA 개인키이다.
    
- `ca.crt`: 서버/클라가 신뢰할 루트 CA 인증서이다.
    

### 1-2) 서버 인증서 (IP SAN 포함)

`certs/openssl-server.cnf` 생성:

`[ req ] default_bits       = 2048 prompt             = no default_md         = sha256 req_extensions     = req_ext distinguished_name = dn  [ dn ] CN = quic-tunnel-server  [ req_ext ] subjectAltName = @alt_names  [ alt_names ] IP.1 = <PUBLIC_IP>`

`<PUBLIC_IP>`를 **네 공인 IP로 치환**한다.

그 다음:

`cd ../../ # (현재: quic-tunnel/) cd certs/out  # 서버 키 + CSR openssl genrsa -out server.key 2048 openssl req -new -key server.key -out server.csr -config ../openssl-server.cnf  # CA로 서명해서 서버 인증서 발급 openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial \   -out server.crt -days 825 -sha256 -extensions req_ext -extfile ../openssl-server.cnf`

검증(중요):

`openssl x509 -in server.crt -noout -text | grep -A2 "Subject Alternative Name"`

출력에 `IP Address:<PUBLIC_IP>`가 보여야 한다.

### 1-3) 클라이언트 인증서 (클라 인증서가 “키” 역할)

`# 클라 키 + CSR openssl genrsa -out client.key 2048 openssl req -new -key client.key -subj "/CN=quic-tunnel-client-1" -out client.csr  # CA로 서명해서 클라 인증서 발급 openssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial \   -out client.crt -days 825 -sha256`